<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>unitTests.ml &mdash; Coverage report</title>
    <meta name="description" content="100.00% coverage in lib/parser/unitTests/unitTests.ml">
    <link rel="stylesheet" href="../../../coverage.css"/>
    <script src="../../../highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div id="header">
      <h1>
        <a href="../../../index.html">
          <span class="dirname">lib/parser/unitTests/</span>unitTests.ml
        </a>
      </h1>
      <h2>100.00%</h2>
    </div>
    <div id="navbar">
    </div>
    <div id="report">
      <div id="lines-layer">
        <pre>
<a id="L1"></a><span > </span>
<a id="L2"></a><span > </span>
<a id="L3"></a><span > </span>
<a id="L4"></a><span > </span>
<a id="L5"></a><span > </span>
<a id="L6"></a><span > </span>
<a id="L7"></a><span > </span>
<a id="L8"></a><span > </span>
<a id="L9"></a><span > </span>
<a id="L10"></a><span > </span>
<a id="L11"></a><span > </span>
<a id="L12"></a><span class="visited"> </span>
<a id="L13"></a><span class="visited"> </span>
<a id="L14"></a><span class="visited"> </span>
<a id="L15"></a><span > </span>
<a id="L16"></a><span > </span>
<a id="L17"></a><span > </span>
<a id="L18"></a><span > </span>
<a id="L19"></a><span > </span>
<a id="L20"></a><span class="visited"> </span>
<a id="L21"></a><span class="visited"> </span>
<a id="L22"></a><span > </span>
<a id="L23"></a><span > </span>
<a id="L24"></a><span > </span>
<a id="L25"></a><span class="visited"> </span>
<a id="L26"></a><span class="visited"> </span>
<a id="L27"></a><span > </span>
<a id="L28"></a><span > </span>
<a id="L29"></a><span > </span>
<a id="L30"></a><span > </span>
<a id="L31"></a><span > </span>
<a id="L32"></a><span class="visited"> </span>
<a id="L33"></a><span class="visited"> </span>
<a id="L34"></a><span > </span>
<a id="L35"></a><span > </span>
<a id="L36"></a><span > </span>
<a id="L37"></a><span class="visited"> </span>
<a id="L38"></a><span class="visited"> </span>
<a id="L39"></a><span > </span>
<a id="L40"></a><span > </span>
<a id="L41"></a><span > </span>
<a id="L42"></a><span class="visited"> </span>
<a id="L43"></a><span class="visited"> </span>
<a id="L44"></a><span > </span>
<a id="L45"></a><span > </span>
<a id="L46"></a><span > </span>
<a id="L47"></a><span class="visited"> </span>
<a id="L48"></a><span class="visited"> </span>
<a id="L49"></a><span > </span>
<a id="L50"></a><span > </span>
<a id="L51"></a><span > </span>
<a id="L52"></a><span class="visited"> </span>
<a id="L53"></a><span class="visited"> </span>
<a id="L54"></a><span > </span>
<a id="L55"></a><span > </span>
<a id="L56"></a><span > </span>
<a id="L57"></a><span class="visited"> </span>
<a id="L58"></a><span class="visited"> </span>
<a id="L59"></a><span > </span>
<a id="L60"></a><span > </span>
<a id="L61"></a><span > </span>
<a id="L62"></a><span class="visited"> </span>
<a id="L63"></a><span class="visited"> </span>
<a id="L64"></a><span > </span>
<a id="L65"></a><span > </span>
<a id="L66"></a><span > </span>
<a id="L67"></a><span class="visited"> </span>
<a id="L68"></a><span class="visited"> </span>
<a id="L69"></a><span > </span>
<a id="L70"></a><span > </span>
<a id="L71"></a><span > </span>
<a id="L72"></a><span class="visited"> </span>
<a id="L73"></a><span class="visited"> </span>
<a id="L74"></a><span > </span>
<a id="L75"></a><span > </span>
<a id="L76"></a><span > </span>
<a id="L77"></a><span class="visited"> </span>
<a id="L78"></a><span class="visited"> </span>
<a id="L79"></a><span > </span>
<a id="L80"></a><span > </span>
<a id="L81"></a><span > </span>
<a id="L82"></a><span class="visited"> </span>
<a id="L83"></a><span class="visited"> </span>
<a id="L84"></a><span > </span>
<a id="L85"></a><span > </span>
<a id="L86"></a><span > </span>
<a id="L87"></a><span class="visited"> </span>
<a id="L88"></a><span class="visited"> </span>
<a id="L89"></a><span > </span>
<a id="L90"></a><span > </span>
<a id="L91"></a><span > </span>
<a id="L92"></a><span class="visited"> </span>
<a id="L93"></a><span class="visited"> </span>
<a id="L94"></a><span > </span>
<a id="L95"></a><span > </span>
<a id="L96"></a><span > </span>
<a id="L97"></a><span > </span>
<a id="L98"></a><span class="visited"> </span>
<a id="L99"></a><span class="visited"> </span>
<a id="L100"></a><span > </span>
<a id="L101"></a><span > </span>
<a id="L102"></a><span > </span>
<a id="L103"></a><span class="visited"> </span>
<a id="L104"></a><span class="visited"> </span>
<a id="L105"></a><span > </span>
<a id="L106"></a><span > </span>
<a id="L107"></a><span > </span>
<a id="L108"></a><span class="visited"> </span>
<a id="L109"></a><span class="visited"> </span>
<a id="L110"></a><span > </span>
<a id="L111"></a><span > </span>
<a id="L112"></a><span > </span>
<a id="L113"></a><span class="visited"> </span>
<a id="L114"></a><span class="visited"> </span>
<a id="L115"></a><span > </span>
<a id="L116"></a><span > </span>
<a id="L117"></a><span > </span>
<a id="L118"></a><span class="visited"> </span>
<a id="L119"></a><span class="visited"> </span>
<a id="L120"></a><span > </span>
<a id="L121"></a><span > </span>
<a id="L122"></a><span > </span>
<a id="L123"></a><span class="visited"> </span>
<a id="L124"></a><span class="visited"> </span>
<a id="L125"></a><span > </span>
<a id="L126"></a><span > </span>
<a id="L127"></a><span > </span>
<a id="L128"></a><span class="visited"> </span>
<a id="L129"></a><span > </span>
<a id="L130"></a><span > </span>
<a id="L131"></a><span > </span>
<a id="L132"></a><span class="visited"> </span>
<a id="L133"></a><span class="visited"> </span>
<a id="L134"></a><span class="visited"> </span>
<a id="L135"></a><span > </span>
<a id="L136"></a><span > </span>
<a id="L137"></a><span > </span>
<a id="L138"></a><span class="visited"> </span>
<a id="L139"></a><span class="visited"> </span>
<a id="L140"></a><span > </span>
<a id="L141"></a><span > </span>
<a id="L142"></a><span > </span>
<a id="L143"></a><span class="visited"> </span>
<a id="L144"></a><span class="visited"> </span>
<a id="L145"></a><span > </span>
<a id="L146"></a><span class="visited"> </span>
<a id="L147"></a><span > </span>
<a id="L148"></a><span > </span>
<a id="L149"></a><span > </span>
<a id="L150"></a><span > </span>
<a id="L151"></a><span class="visited"> </span>
<a id="L152"></a><span class="visited"> </span>
<a id="L153"></a><span class="visited"> </span>
<a id="L154"></a><span > </span>
<a id="L155"></a><span > </span>
<a id="L156"></a><span > </span>
<a id="L157"></a><span class="visited"> </span>
<a id="L158"></a><span class="visited"> </span>
<a id="L159"></a><span class="visited"> </span>
<a id="L160"></a><span > </span>
<a id="L161"></a><span > </span>
<a id="L162"></a><span > </span>
<a id="L163"></a><span class="visited"> </span>
<a id="L164"></a><span class="visited"> </span>
<a id="L165"></a><span class="visited"> </span>
<a id="L166"></a><span > </span>
<a id="L167"></a><span > </span>
<a id="L168"></a><span > </span>
<a id="L169"></a><span class="visited"> </span>
<a id="L170"></a><span class="visited"> </span>
<a id="L171"></a><span class="visited"> </span>
<a id="L172"></a><span > </span>
<a id="L173"></a><span > </span>
<a id="L174"></a><span > </span>
<a id="L175"></a><span class="visited"> </span>
<a id="L176"></a><span class="visited"> </span>
<a id="L177"></a><span > </span>
<a id="L178"></a><span > </span>
<a id="L179"></a><span > </span>
<a id="L180"></a><span class="visited"> </span>
<a id="L181"></a><span class="visited"> </span>
<a id="L182"></a><span > </span>
<a id="L183"></a><span > </span>
<a id="L184"></a><span > </span>
<a id="L185"></a><span class="visited"> </span>
<a id="L186"></a><span > </span>
<a id="L187"></a><span > </span>
<a id="L188"></a><span > </span>
<a id="L189"></a><span class="visited"> </span>
<a id="L190"></a><span class="visited"> </span>
<a id="L191"></a><span > </span>
<a id="L192"></a><span > </span>
<a id="L193"></a><span > </span>
<a id="L194"></a><span class="visited"> </span>
<a id="L195"></a><span class="visited"> </span>
<a id="L196"></a><span > </span>
<a id="L197"></a><span > </span>
<a id="L198"></a><span > </span>
<a id="L199"></a><span class="visited"> </span>
<a id="L200"></a><span class="visited"> </span>
<a id="L201"></a><span > </span>
<a id="L202"></a><span > </span>
<a id="L203"></a><span > </span>
<a id="L204"></a><span class="visited"> </span>
<a id="L205"></a><span class="visited"> </span>
<a id="L206"></a><span > </span>
<a id="L207"></a><span > </span>
<a id="L208"></a><span > </span>
<a id="L209"></a><span class="visited"> </span>
<a id="L210"></a><span class="visited"> </span>
<a id="L211"></a><span > </span>
<a id="L212"></a><span > </span>
<a id="L213"></a><span > </span>
<a id="L214"></a><span class="visited"> </span>
<a id="L215"></a><span > </span>
<a id="L216"></a><span > </span>
<a id="L217"></a><span > </span>
<a id="L218"></a><span class="visited"> </span>
<a id="L219"></a><span class="visited"> </span>
<a id="L220"></a><span > </span>
<a id="L221"></a><span > </span>
<a id="L222"></a><span > </span>
<a id="L223"></a><span class="visited"> </span>
<a id="L224"></a><span class="visited"> </span>
<a id="L225"></a><span > </span>
<a id="L226"></a><span > </span>
<a id="L227"></a><span class="visited"> </span>
<a id="L228"></a><span > </span>
<a id="L229"></a><span > </span>
<a id="L230"></a><span > </span>
<a id="L231"></a><span class="visited"> </span>
<a id="L232"></a><span class="visited"> </span>
<a id="L233"></a><span > </span>
<a id="L234"></a><span > </span>
<a id="L235"></a><span > </span>
<a id="L236"></a><span class="visited"> </span>
<a id="L237"></a><span class="visited"> </span>
<a id="L238"></a><span > </span>
<a id="L239"></a><span > </span>
<a id="L240"></a><span class="visited"> </span>
<a id="L241"></a><span > </span>
<a id="L242"></a><span > </span>
<a id="L243"></a><span > </span>
<a id="L244"></a><span class="visited"> </span>
<a id="L245"></a><span class="visited"> </span>
<a id="L246"></a><span > </span>
<a id="L247"></a><span > </span>
<a id="L248"></a><span > </span>
<a id="L249"></a><span > </span>
<a id="L250"></a><span class="visited"> </span>
<a id="L251"></a><span > </span>
<a id="L252"></a><span > </span>
<a id="L253"></a><span > </span>
<a id="L254"></a><span class="visited"> </span>
<a id="L255"></a><span class="visited"> </span>
<a id="L256"></a><span > </span>
<a id="L257"></a><span > </span>
<a id="L258"></a><span class="visited"> </span>
<a id="L259"></a><span > </span>
<a id="L260"></a><span > </span>
<a id="L261"></a><span > </span>
<a id="L262"></a><span class="visited"> </span>
<a id="L263"></a><span class="visited"> </span>
<a id="L264"></a><span > </span>
<a id="L265"></a><span class="visited"> </span>
<a id="L266"></a><span > </span>
<a id="L267"></a><span > </span>
<a id="L268"></a><span > </span>
<a id="L269"></a><span class="visited"> </span>
<a id="L270"></a><span class="visited"> </span>
<a id="L271"></a><span > </span>
<a id="L272"></a><span > </span>
<a id="L273"></a><span class="visited"> </span>
<a id="L274"></a><span > </span>
<a id="L275"></a><span > </span>
<a id="L276"></a><span > </span>
<a id="L277"></a><span class="visited"> </span>
<a id="L278"></a><span class="visited"> </span>
<a id="L279"></a><span class="visited"> </span>
<a id="L280"></a><span > </span>
<a id="L281"></a><span > </span>
<a id="L282"></a><span > </span>
<a id="L283"></a><span class="visited"> </span>
<a id="L284"></a><span class="visited"> </span>
<a id="L285"></a><span class="visited"> </span>
<a id="L286"></a><span > </span>
<a id="L287"></a><span > </span>
<a id="L288"></a><span > </span>
<a id="L289"></a><span class="visited"> </span>
<a id="L290"></a><span class="visited"> </span>
<a id="L291"></a><span > </span>
<a id="L292"></a><span > </span>
<a id="L293"></a><span class="visited"> </span>
<a id="L294"></a><span > </span>
<a id="L295"></a><span > </span>
<a id="L296"></a><span > </span>
<a id="L297"></a><span class="visited"> </span>
<a id="L298"></a><span class="visited"> </span>
<a id="L299"></a><span > </span>
<a id="L300"></a><span > </span>
<a id="L301"></a><span class="visited"> </span>
<a id="L302"></a><span > </span>
<a id="L303"></a><span > </span>
<a id="L304"></a><span > </span>
<a id="L305"></a><span class="visited"> </span>
<a id="L306"></a><span class="visited"> </span>
<a id="L307"></a><span > </span>
<a id="L308"></a><span > </span>
<a id="L309"></a><span > </span>
<a id="L310"></a><span > </span>
<a id="L311"></a><span class="visited"> </span>
<a id="L312"></a><span > </span>
<a id="L313"></a><span > </span>
<a id="L314"></a><span > </span>
<a id="L315"></a><span class="visited"> </span>
<a id="L316"></a><span class="visited"> </span>
<a id="L317"></a><span > </span>
<a id="L318"></a><span > </span>
<a id="L319"></a><span > </span>
<a id="L320"></a><span > </span>
<a id="L321"></a><span class="visited"> </span>
<a id="L322"></a><span > </span>
<a id="L323"></a><span > </span>
<a id="L324"></a><span > </span>
<a id="L325"></a><span class="visited"> </span>
<a id="L326"></a><span class="visited"> </span>
<a id="L327"></a><span > </span>
<a id="L328"></a><span > </span>
<a id="L329"></a><span > </span>
<a id="L330"></a><span > </span>
<a id="L331"></a><span > </span>
<a id="L332"></a><span > </span>
<a id="L333"></a><span > </span>
<a id="L334"></a><span > </span>
<a id="L335"></a><span > </span>
<a id="L336"></a><span > </span>
<a id="L337"></a><span > </span>
<a id="L338"></a><span > </span>
<a id="L339"></a><span class="visited"> </span>
<a id="L340"></a><span > </span>
</pre>
      </div>
      <div id="text-layer">
        <pre id="line-numbers">
<a href="#L1">  1</a>
<a href="#L2">  2</a>
<a href="#L3">  3</a>
<a href="#L4">  4</a>
<a href="#L5">  5</a>
<a href="#L6">  6</a>
<a href="#L7">  7</a>
<a href="#L8">  8</a>
<a href="#L9">  9</a>
<a href="#L10"> 10</a>
<a href="#L11"> 11</a>
<a href="#L12"> 12</a>
<a href="#L13"> 13</a>
<a href="#L14"> 14</a>
<a href="#L15"> 15</a>
<a href="#L16"> 16</a>
<a href="#L17"> 17</a>
<a href="#L18"> 18</a>
<a href="#L19"> 19</a>
<a href="#L20"> 20</a>
<a href="#L21"> 21</a>
<a href="#L22"> 22</a>
<a href="#L23"> 23</a>
<a href="#L24"> 24</a>
<a href="#L25"> 25</a>
<a href="#L26"> 26</a>
<a href="#L27"> 27</a>
<a href="#L28"> 28</a>
<a href="#L29"> 29</a>
<a href="#L30"> 30</a>
<a href="#L31"> 31</a>
<a href="#L32"> 32</a>
<a href="#L33"> 33</a>
<a href="#L34"> 34</a>
<a href="#L35"> 35</a>
<a href="#L36"> 36</a>
<a href="#L37"> 37</a>
<a href="#L38"> 38</a>
<a href="#L39"> 39</a>
<a href="#L40"> 40</a>
<a href="#L41"> 41</a>
<a href="#L42"> 42</a>
<a href="#L43"> 43</a>
<a href="#L44"> 44</a>
<a href="#L45"> 45</a>
<a href="#L46"> 46</a>
<a href="#L47"> 47</a>
<a href="#L48"> 48</a>
<a href="#L49"> 49</a>
<a href="#L50"> 50</a>
<a href="#L51"> 51</a>
<a href="#L52"> 52</a>
<a href="#L53"> 53</a>
<a href="#L54"> 54</a>
<a href="#L55"> 55</a>
<a href="#L56"> 56</a>
<a href="#L57"> 57</a>
<a href="#L58"> 58</a>
<a href="#L59"> 59</a>
<a href="#L60"> 60</a>
<a href="#L61"> 61</a>
<a href="#L62"> 62</a>
<a href="#L63"> 63</a>
<a href="#L64"> 64</a>
<a href="#L65"> 65</a>
<a href="#L66"> 66</a>
<a href="#L67"> 67</a>
<a href="#L68"> 68</a>
<a href="#L69"> 69</a>
<a href="#L70"> 70</a>
<a href="#L71"> 71</a>
<a href="#L72"> 72</a>
<a href="#L73"> 73</a>
<a href="#L74"> 74</a>
<a href="#L75"> 75</a>
<a href="#L76"> 76</a>
<a href="#L77"> 77</a>
<a href="#L78"> 78</a>
<a href="#L79"> 79</a>
<a href="#L80"> 80</a>
<a href="#L81"> 81</a>
<a href="#L82"> 82</a>
<a href="#L83"> 83</a>
<a href="#L84"> 84</a>
<a href="#L85"> 85</a>
<a href="#L86"> 86</a>
<a href="#L87"> 87</a>
<a href="#L88"> 88</a>
<a href="#L89"> 89</a>
<a href="#L90"> 90</a>
<a href="#L91"> 91</a>
<a href="#L92"> 92</a>
<a href="#L93"> 93</a>
<a href="#L94"> 94</a>
<a href="#L95"> 95</a>
<a href="#L96"> 96</a>
<a href="#L97"> 97</a>
<a href="#L98"> 98</a>
<a href="#L99"> 99</a>
<a href="#L100">100</a>
<a href="#L101">101</a>
<a href="#L102">102</a>
<a href="#L103">103</a>
<a href="#L104">104</a>
<a href="#L105">105</a>
<a href="#L106">106</a>
<a href="#L107">107</a>
<a href="#L108">108</a>
<a href="#L109">109</a>
<a href="#L110">110</a>
<a href="#L111">111</a>
<a href="#L112">112</a>
<a href="#L113">113</a>
<a href="#L114">114</a>
<a href="#L115">115</a>
<a href="#L116">116</a>
<a href="#L117">117</a>
<a href="#L118">118</a>
<a href="#L119">119</a>
<a href="#L120">120</a>
<a href="#L121">121</a>
<a href="#L122">122</a>
<a href="#L123">123</a>
<a href="#L124">124</a>
<a href="#L125">125</a>
<a href="#L126">126</a>
<a href="#L127">127</a>
<a href="#L128">128</a>
<a href="#L129">129</a>
<a href="#L130">130</a>
<a href="#L131">131</a>
<a href="#L132">132</a>
<a href="#L133">133</a>
<a href="#L134">134</a>
<a href="#L135">135</a>
<a href="#L136">136</a>
<a href="#L137">137</a>
<a href="#L138">138</a>
<a href="#L139">139</a>
<a href="#L140">140</a>
<a href="#L141">141</a>
<a href="#L142">142</a>
<a href="#L143">143</a>
<a href="#L144">144</a>
<a href="#L145">145</a>
<a href="#L146">146</a>
<a href="#L147">147</a>
<a href="#L148">148</a>
<a href="#L149">149</a>
<a href="#L150">150</a>
<a href="#L151">151</a>
<a href="#L152">152</a>
<a href="#L153">153</a>
<a href="#L154">154</a>
<a href="#L155">155</a>
<a href="#L156">156</a>
<a href="#L157">157</a>
<a href="#L158">158</a>
<a href="#L159">159</a>
<a href="#L160">160</a>
<a href="#L161">161</a>
<a href="#L162">162</a>
<a href="#L163">163</a>
<a href="#L164">164</a>
<a href="#L165">165</a>
<a href="#L166">166</a>
<a href="#L167">167</a>
<a href="#L168">168</a>
<a href="#L169">169</a>
<a href="#L170">170</a>
<a href="#L171">171</a>
<a href="#L172">172</a>
<a href="#L173">173</a>
<a href="#L174">174</a>
<a href="#L175">175</a>
<a href="#L176">176</a>
<a href="#L177">177</a>
<a href="#L178">178</a>
<a href="#L179">179</a>
<a href="#L180">180</a>
<a href="#L181">181</a>
<a href="#L182">182</a>
<a href="#L183">183</a>
<a href="#L184">184</a>
<a href="#L185">185</a>
<a href="#L186">186</a>
<a href="#L187">187</a>
<a href="#L188">188</a>
<a href="#L189">189</a>
<a href="#L190">190</a>
<a href="#L191">191</a>
<a href="#L192">192</a>
<a href="#L193">193</a>
<a href="#L194">194</a>
<a href="#L195">195</a>
<a href="#L196">196</a>
<a href="#L197">197</a>
<a href="#L198">198</a>
<a href="#L199">199</a>
<a href="#L200">200</a>
<a href="#L201">201</a>
<a href="#L202">202</a>
<a href="#L203">203</a>
<a href="#L204">204</a>
<a href="#L205">205</a>
<a href="#L206">206</a>
<a href="#L207">207</a>
<a href="#L208">208</a>
<a href="#L209">209</a>
<a href="#L210">210</a>
<a href="#L211">211</a>
<a href="#L212">212</a>
<a href="#L213">213</a>
<a href="#L214">214</a>
<a href="#L215">215</a>
<a href="#L216">216</a>
<a href="#L217">217</a>
<a href="#L218">218</a>
<a href="#L219">219</a>
<a href="#L220">220</a>
<a href="#L221">221</a>
<a href="#L222">222</a>
<a href="#L223">223</a>
<a href="#L224">224</a>
<a href="#L225">225</a>
<a href="#L226">226</a>
<a href="#L227">227</a>
<a href="#L228">228</a>
<a href="#L229">229</a>
<a href="#L230">230</a>
<a href="#L231">231</a>
<a href="#L232">232</a>
<a href="#L233">233</a>
<a href="#L234">234</a>
<a href="#L235">235</a>
<a href="#L236">236</a>
<a href="#L237">237</a>
<a href="#L238">238</a>
<a href="#L239">239</a>
<a href="#L240">240</a>
<a href="#L241">241</a>
<a href="#L242">242</a>
<a href="#L243">243</a>
<a href="#L244">244</a>
<a href="#L245">245</a>
<a href="#L246">246</a>
<a href="#L247">247</a>
<a href="#L248">248</a>
<a href="#L249">249</a>
<a href="#L250">250</a>
<a href="#L251">251</a>
<a href="#L252">252</a>
<a href="#L253">253</a>
<a href="#L254">254</a>
<a href="#L255">255</a>
<a href="#L256">256</a>
<a href="#L257">257</a>
<a href="#L258">258</a>
<a href="#L259">259</a>
<a href="#L260">260</a>
<a href="#L261">261</a>
<a href="#L262">262</a>
<a href="#L263">263</a>
<a href="#L264">264</a>
<a href="#L265">265</a>
<a href="#L266">266</a>
<a href="#L267">267</a>
<a href="#L268">268</a>
<a href="#L269">269</a>
<a href="#L270">270</a>
<a href="#L271">271</a>
<a href="#L272">272</a>
<a href="#L273">273</a>
<a href="#L274">274</a>
<a href="#L275">275</a>
<a href="#L276">276</a>
<a href="#L277">277</a>
<a href="#L278">278</a>
<a href="#L279">279</a>
<a href="#L280">280</a>
<a href="#L281">281</a>
<a href="#L282">282</a>
<a href="#L283">283</a>
<a href="#L284">284</a>
<a href="#L285">285</a>
<a href="#L286">286</a>
<a href="#L287">287</a>
<a href="#L288">288</a>
<a href="#L289">289</a>
<a href="#L290">290</a>
<a href="#L291">291</a>
<a href="#L292">292</a>
<a href="#L293">293</a>
<a href="#L294">294</a>
<a href="#L295">295</a>
<a href="#L296">296</a>
<a href="#L297">297</a>
<a href="#L298">298</a>
<a href="#L299">299</a>
<a href="#L300">300</a>
<a href="#L301">301</a>
<a href="#L302">302</a>
<a href="#L303">303</a>
<a href="#L304">304</a>
<a href="#L305">305</a>
<a href="#L306">306</a>
<a href="#L307">307</a>
<a href="#L308">308</a>
<a href="#L309">309</a>
<a href="#L310">310</a>
<a href="#L311">311</a>
<a href="#L312">312</a>
<a href="#L313">313</a>
<a href="#L314">314</a>
<a href="#L315">315</a>
<a href="#L316">316</a>
<a href="#L317">317</a>
<a href="#L318">318</a>
<a href="#L319">319</a>
<a href="#L320">320</a>
<a href="#L321">321</a>
<a href="#L322">322</a>
<a href="#L323">323</a>
<a href="#L324">324</a>
<a href="#L325">325</a>
<a href="#L326">326</a>
<a href="#L327">327</a>
<a href="#L328">328</a>
<a href="#L329">329</a>
<a href="#L330">330</a>
<a href="#L331">331</a>
<a href="#L332">332</a>
<a href="#L333">333</a>
<a href="#L334">334</a>
<a href="#L335">335</a>
<a href="#L336">336</a>
<a href="#L337">337</a>
<a href="#L338">338</a>
<a href="#L339">339</a>
<a href="#L340">340</a>
</pre>
<pre><code class="ocaml">(* Copyright 2024, Victoria Lutsyuk *)

(* SPDX-License-Identifier: MIT *)

open Angstrom
open Ast
open Aux
open Pat
open Expr

let pp printer parser str =
  <span data-count="50">m</span>atch parse_string ~consume:Angstrom.Consume.All parser str with
  | <span data-count="43">O</span>k res -&gt; printer Format.std_formatter res
  | <span data-count="7">E</span>rror _ -&gt; print_endline "Syntax error"
;;

(* ================================ auxiliaries ================================ *)

let%expect_test "normal_id" =
  <span data-count="1">p</span>p Format.pp_print_string pid "id";
  <span data-count="1">[</span>%expect {| id |}<span data-count="9">]</span>
;;

let%expect_test "keyword_id" =
  <span data-count="1">p</span>p Format.pp_print_string pid "while";
  <span data-count="1">[</span>%expect {| Syntax error |}<span data-count="9">]</span>
;;

(* ================================= constants ================================= *)

let%expect_test "num_with_plus" =
  <span data-count="1">p</span>p pp_const pint "+2024";
  <span data-count="1">[</span>%expect {| (Int 2024) |}<span data-count="9">]</span>
;;

let%expect_test "num_with_minus" =
  <span data-count="1">p</span>p pp_const pint "-2024";
  <span data-count="1">[</span>%expect {| (Int -2024) |}<span data-count="9">]</span>
;;

let%expect_test "num_without_sign_before" =
  <span data-count="1">p</span>p pp_const pint "2024\n";
  <span data-count="1">[</span>%expect {| (Int 2024) |}<span data-count="9">]</span>
;;

let%expect_test "two_signs_before_number" =
  <span data-count="1">p</span>p pp_const pint "+-2024";
  <span data-count="1">[</span>%expect {| Syntax error |}<span data-count="9">]</span>
;;

let%expect_test "string_with_//" =
  <span data-count="1">p</span>p pp_const pstr "{|str//|}";
  <span data-count="1">[</span>%expect {| (Str "str//") |}<span data-count="9">]</span>
;;

let%expect_test "incorrect_string" =
  <span data-count="1">p</span>p pp_const pstr "str//";
  <span data-count="1">[</span>%expect {| Syntax error |}<span data-count="9">]</span>
;;

let%expect_test "empty_string" =
  <span data-count="1">p</span>p pp_const pstr "{||}";
  <span data-count="1">[</span>%expect {| (Str "") |}<span data-count="9">]</span>
;;

let%expect_test "one_space_string" =
  <span data-count="1">p</span>p pp_const pstr "{| |}";
  <span data-count="1">[</span>%expect {| (Str " ") |}<span data-count="9">]</span>
;;

let%expect_test "true" =
  <span data-count="1">p</span>p pp_const pbool "true";
  <span data-count="1">[</span>%expect {| (Bool true) |}<span data-count="9">]</span>
;;

let%expect_test "false" =
  <span data-count="1">p</span>p pp_const pbool "false";
  <span data-count="1">[</span>%expect {| (Bool false) |}<span data-count="9">]</span>
;;

let%expect_test "incorrect_bool_with_char_after" =
  <span data-count="1">p</span>p pp_const pbool "truee";
  <span data-count="1">[</span>%expect {| Syntax error |}<span data-count="9">]</span>
;;

let%expect_test "'\n'_after_bool" =
  <span data-count="1">p</span>p pp_const pbool "true\n";
  <span data-count="1">[</span>%expect {| (Bool true) |}<span data-count="9">]</span>
;;

let%expect_test "unit" =
  <span data-count="1">p</span>p pp_const punit " ()\n";
  <span data-count="1">[</span>%expect {| Unit |}<span data-count="9">]</span>
;;

(* patterns *)
let%expect_test "pat_var" =
  <span data-count="1">p</span>p pp_pat ppat_var "  meow\n";
  <span data-count="1">[</span>%expect {| (PatVar "meow") |}<span data-count="9">]</span>
;;

let%expect_test "pat_cons" =
  <span data-count="1">p</span>p pp_pat ppat_const "  \r{|meow|}\n";
  <span data-count="1">[</span>%expect {| (PatConst (Str "meow")) |}<span data-count="9">]</span>
;;

let%expect_test "pat_empty_str" =
  <span data-count="1">p</span>p pp_pat ppat_const "  \r{||}\n";
  <span data-count="1">[</span>%expect {| (PatConst (Str "")) |}<span data-count="9">]</span>
;;

let%expect_test "pat_any" =
  <span data-count="1">p</span>p pp_pat ppat_any "  \r_\n";
  <span data-count="1">[</span>%expect {| PatAny |}<span data-count="9">]</span>
;;

let%expect_test "pat_simple_tuple" =
  <span data-count="1">p</span>p pp_pat (ppat_tupl<span data-count="1">e</span> ppat) "(1,2,3)";
  <span data-count="1">[</span>%expect {| (PatTup ((PatConst (Int 1)), (PatConst (Int 2)), [(PatConst (Int 3))])) |}<span data-count="9">]</span>
;;

let%expect_test "pat_tuple_of_tuple" =
  <span data-count="1">p</span>p pp_pat (ppat_tupl<span data-count="1">e</span> ppat) "(1,2,(3, 4, 5))";
  <span data-count="1">[</span>%expect
    {|
    (PatTup ((PatConst (Int 1)), (PatConst (Int 2)),
       [(PatTup ((PatConst (Int 3)), (PatConst (Int 4)), [(PatConst (Int 5))]))]
       )) |}<span data-count="9">]</span>
;;

let%expect_test "incorrect_pat_tuple_of_one_element" =
  <span data-count="1">p</span>p pp_pat (ppat_tupl<span data-count="1">e</span> ppat) "(1)";
  <span data-count="1">[</span>%expect {|
    Syntax error |}<span data-count="9">]</span>
;;

let%expect_test "pat_x" =
  <span data-count="1">p</span>p pp_pat ppat "  x ";
  <span data-count="1">[</span>%expect {| (PatVar "x") |}<span data-count="9">]</span>
;;

let%expect_test "mixed_pat" =
  <span data-count="1">p</span>p pp_pat ppat "  \r(\r(  (_,\r_), _)\n, _)\n\n";
  <span data-count="1">[</span>%expect
    {|
    (PatTup ((PatTup ((PatTup (PatAny, PatAny, [])), PatAny, [])), PatAny, [])) |}<span data-count="9">]</span>
;;

(* expressions *)
let%expect_test "expr_var" =
  <span data-count="1">p</span>p pp_expr pexpr_var "  meow\n   ";
  <span data-count="1">[</span>%expect {|
    (Var "meow") |}<span data-count="9">]</span>
;;

let%expect_test "expr_cons_int" =
  <span data-count="1">p</span>p pp_expr pexpr_const "1";
  <span data-count="1">[</span>%expect {|
    (Const (Int 1)) |}<span data-count="9">]</span>
;;

let%expect_test "expr_cons_str" =
  <span data-count="1">p</span>p pp_expr pexpr_const "  {|meow|}  ";
  <span data-count="1">[</span>%expect {|
    (Const (Str "meow")) |}<span data-count="9">]</span>
;;

let%expect_test "expr_cons_unit" =
  <span data-count="1">p</span>p pp_expr pexpr_const "  ()  ";
  <span data-count="1">[</span>%expect {|
    (Const Unit) |}<span data-count="9">]</span>
;;

let%expect_test "simple_list" =
  <span data-count="1">p</span>p pp_expr (pexpr_lis<span data-count="1">t</span> pexpr) "   [ 1 ; 2\n; 3]   ";
  <span data-count="1">[</span>%expect {| (List [(Const (Int 1)); (Const (Int 2)); (Const (Int 3))]) |}<span data-count="9">]</span>
;;

let%expect_test "complex_list" =
  <span data-count="1">p</span>p pp_expr (pexpr_lis<span data-count="1">t</span> pexpr) "   [ [1;2;3] ; 2\n; 3]   ";
  <span data-count="1">[</span>%expect
    {|
    (List
       [(List [(Const (Int 1)); (Const (Int 2)); (Const (Int 3))]);
         (Const (Int 2)); (Const (Int 3))]) |}<span data-count="9">]</span>
;;

let%expect_test "empty_list" =
  <span data-count="1">p</span>p pp_expr (pexpr_lis<span data-count="1">t</span> pexpr) "[]";
  <span data-count="1">[</span>%expect {| (List []) |}<span data-count="9">]</span>
;;

let%expect_test "incorrect_list_diff_types" =
  <span data-count="1">p</span>p pp_expr (pexpr_lis<span data-count="1">t</span> pexpr) "[1, {|meow|}]";
  <span data-count="1">[</span>%expect {| Syntax error |}<span data-count="9">]</span>
;;

let%expect_test "simple_tuple" =
  <span data-count="1">p</span>p pp_expr (pexpr_tupl<span data-count="1">e</span> pexpr) "(1, 2, 3)";
  <span data-count="1">[</span>%expect {| (Tup ((Const (Int 1)), (Const (Int 2)), [(Const (Int 3))])) |}<span data-count="9">]</span>
;;

let%expect_test "incorrect_tuple_one_el" =
  <span data-count="1">p</span>p pp_expr (pexpr_tupl<span data-count="1">e</span> pexpr) "(1)";
  <span data-count="1">[</span>%expect {| Syntax error |}<span data-count="9">]</span>
;;

let%expect_test "complex_tuple" =
  <span data-count="1">p</span>p pp_expr (pexpr_tupl<span data-count="1">e</span> pexpr) "((1, 1, 1), (2, 2, 2), {|meow|})";
  <span data-count="1">[</span>%expect
    {|
    (Tup ((Tup ((Const (Int 1)), (Const (Int 1)), [(Const (Int 1))])),
       (Tup ((Const (Int 2)), (Const (Int 2)), [(Const (Int 2))])),
       [(Const (Str "meow"))])) |}<span data-count="9">]</span>
;;

let%expect_test "simple_fun" =
  <span data-count="1">p</span>p pp_expr (pexpr_fu<span data-count="1">n</span> ppat pexpr) "fun x -&gt; x";
  <span data-count="1">[</span>%expect {| (Fun ((PatVar "x"), (Var "x"))) |}<span data-count="9">]</span>
;;

let%expect_test "fun_two_var" =
  <span data-count="1">p</span>p pp_expr (pexpr_fu<span data-count="1">n</span> ppat pexpr) "fun x y -&gt; x + y";
  <span data-count="1">[</span>%expect
    {|
    (Fun ((PatVar "x"), (Fun ((PatVar "y"), (BinOp (Add, (Var "x"), (Var "y")))))
       )) |}<span data-count="9">]</span>
;;

let%expect_test "fun_of_fun" =
  <span data-count="1">p</span>p pp_expr (pexpr_fu<span data-count="1">n</span> ppat pexpr) "fun x -&gt; fun _ -&gt; x";
  <span data-count="1">[</span>%expect {| (Fun ((PatVar "x"), (Fun (PatAny, (Var "x"))))) |}<span data-count="9">]</span>
;;

let%expect_test "simple_let" =
  <span data-count="1">p</span>p pp_expr (pexpr_le<span data-count="1">t</span> pexpr) "let x = 1";
  <span data-count="1">[</span>%expect
    {|
    (Let ({ is_rec = NonRec; pat = (PatVar "x"); expr = (Const (Int 1)) },
       (Const Unit))) |}<span data-count="9">]</span>
;;

let%expect_test "let_two_var" =
  <span data-count="1">p</span>p pp_expr (pexpr_le<span data-count="1">t</span> pexpr) "let x y = x + y";
  <span data-count="1">[</span>%expect
    {|
    (Let (
       { is_rec = NonRec; pat = (PatVar "x");
         expr = (Fun ((PatVar "y"), (BinOp (Add, (Var "x"), (Var "y"))))) },
       (Const Unit))) |}<span data-count="9">]</span>
;;

let%expect_test "let_rec" =
  <span data-count="1">p</span>p pp_expr (pexpr_le<span data-count="1">t</span> pexpr) "let rec x = 1";
  <span data-count="1">[</span>%expect
    {|
    (Let ({ is_rec = Rec; pat = (PatVar "x"); expr = (Const (Int 1)) },
       (Const Unit))) |}<span data-count="9">]</span>
;;

let%expect_test "let_unit" =
  <span data-count="1">p</span>p pp_expr (pexpr_le<span data-count="1">t</span> pexpr) "let _ = ()";
  <span data-count="1">[</span>%expect
    {|
    (Let ({ is_rec = NonRec; pat = PatAny; expr = (Const Unit) }, (Const Unit))) |}<span data-count="9">]</span>
;;

let%expect_test "let_with_in" =
  <span data-count="1">p</span>p pp_expr (pexpr_le<span data-count="1">t</span> pexpr) "let meow = 5 in meow + 1";
  <span data-count="1">[</span>%expect
    {|
    (Let ({ is_rec = NonRec; pat = (PatVar "meow"); expr = (Const (Int 5)) },
       (BinOp (Add, (Var "meow"), (Const (Int 1)))))) |}<span data-count="9">]</span>
;;

let%expect_test "simple_app" =
  <span data-count="1">p</span>p pp_expr (pexpr_ap<span data-count="1">p</span> pexpr) "fact 1";
  <span data-count="1">[</span>%expect {|
    (App ((Var "fact"), (Const (Int 1)))) |}<span data-count="9">]</span>
;;

let%expect_test "app_two_par" =
  <span data-count="1">p</span>p pp_expr (pexpr_ap<span data-count="1">p</span> pexpr) "foo 1 2";
  <span data-count="1">[</span>%expect {|
    (App ((App ((Var "foo"), (Const (Int 1)))), (Const (Int 2)))) |}<span data-count="9">]</span>
;;

let%expect_test "app_in_app" =
  <span data-count="1">p</span>p pp_expr (pexpr_ap<span data-count="1">p</span> pexpr) "foo (g 1) 2";
  <span data-count="1">[</span>%expect
    {|
    (App ((App ((Var "foo"), (App ((Var "g"), (Const (Int 1)))))),
       (Const (Int 2)))) |}<span data-count="9">]</span>
;;

let%expect_test "simple_branch" =
  <span data-count="1">p</span>p pp_expr (pexpr_branc<span data-count="1">h</span> pexpr) "if x = 5 then 7 else 6";
  <span data-count="1">[</span>%expect
    {|
    (Branch ((BinOp (Eq, (Var "x"), (Const (Int 5)))), (Const (Int 7)),
       (Const (Int 6)))) |}<span data-count="9">]</span>
;;

let%expect_test "branch_in_branch" =
  <span data-count="1">p</span>p pp_expr (pexpr_branc<span data-count="1">h</span> pexpr) "if x = 5 then (if x = 7 then 7) else 4";
  <span data-count="1">[</span>%expect
    {|
    (Branch ((BinOp (Eq, (Var "x"), (Const (Int 5)))),
       (Branch ((BinOp (Eq, (Var "x"), (Const (Int 7)))), (Const (Int 7)),
          (Const Unit))),
       (Const (Int 4)))) |}<span data-count="9">]</span>
;;

let%expect_test "simple_match" =
  <span data-count="1">p</span>p pp_expr (pexpr_matc<span data-count="1">h</span> ppat pexpr) "match x with | _ -&gt; x + 5 | c -&gt; meow";
  <span data-count="1">[</span>%expect
    {|
      (Match ((Var "x"),
         { match_pat = PatAny;
           match_expr = (BinOp (Add, (Var "x"), (Const (Int 5)))) },
         [{ match_pat = (PatVar "c"); match_expr = (Var "meow") }])) |}<span data-count="9">]</span>
;;

let%expect_test "factorial" =
  <span data-count="1">p</span>p pp_expr pexpr "let rec fact n = if n &lt;= 1 then 1 else n * fact (n - 1)";
  <span data-count="1">[</span>%expect
    {|
    (Let (
       { is_rec = Rec; pat = (PatVar "fact");
         expr =
         (Fun ((PatVar "n"),
            (Branch ((BinOp (Le, (Var "n"), (Const (Int 1)))), (Const (Int 1)),
               (BinOp (Mul, (Var "n"),
                  (App ((Var "fact"), (BinOp (Sub, (Var "n"), (Const (Int 1))))))
                  ))
               ))
            ))
         },
       (Const Unit))) |}<span data-count="9">]</span>
;;
</code></pre>
      </div>
    </div>
    <script src="../../../coverage.js"></script>
  </body>
</html>
